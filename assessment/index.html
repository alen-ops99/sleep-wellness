<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Assessment | Sleep Wellness by Dr. Alen</title>
    <meta name="description" content="Comprehensive sleep health assessment by Dr. Alen Juginovic. Evaluate your sleep quality, identify potential disorders, and receive personalized recommendations.">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>

<!-- Navigation -->
<nav class="nav" id="nav">
    <a href="../index.html" class="nav-brand">
        <span class="nav-brand-main">SLEEP WELLNESS</span>
        <span class="nav-brand-sub">by Dr. Alen</span>
    </a>
    <div class="nav-links">
        <a href="../hotels.html">Hotels</a>
        <a href="../athletes.html">Athletes</a>
        <a href="../corporate.html">Corporate</a>
        <a href="account.html">My Account</a>
        <a href="../index.html#contact" class="nav-cta">Contact</a>
    </div>
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
    </button>
</nav>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
    <a href="../hotels.html">Hotels</a>
    <a href="../athletes.html">Athletes</a>
    <a href="../corporate.html">Corporate</a>
    <a href="account.html">My Account</a>
    <a href="../index.html#contact">Contact</a>
</div>

<!-- Main App Container -->
<main class="app-container">
    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text">
            <span id="progressStep">Step 1</span>
            <span id="progressPercent">0%</span>
        </div>
    </div>

    <!-- Step Indicators -->
    <div class="step-indicators" id="stepIndicators">
        <!-- Generated by JS -->
    </div>

    <!-- Assessment Content -->
    <div class="assessment-content" id="assessmentContent">
        <!-- Step 1: Welcome -->
        <section class="step-section active" data-step="welcome" style="display: block !important;">
            <div class="welcome-hero">
                <p class="step-label">Comprehensive Sleep Assessment</p>
                <h1 class="step-title">Understand Your Sleep</h1>
                <p class="step-tagline">A physician-designed evaluation of your sleep health</p>
            </div>

            <div class="welcome-content">
                <div class="welcome-intro">
                    <p>
                        This comprehensive assessment uses validated clinical questionnaires to evaluate
                        your sleep patterns, identify potential sleep disorders, and provide personalized
                        recommendations.
                    </p>
                    <div class="welcome-features">
                        <div class="welcome-feature">
                            <div class="feature-icon">15-20</div>
                            <span>Minutes to complete</span>
                        </div>
                        <div class="welcome-feature">
                            <div class="feature-icon">5+</div>
                            <span>Validated questionnaires</span>
                        </div>
                        <div class="welcome-feature">
                            <div class="feature-icon">100%</div>
                            <span>Private & secure</span>
                        </div>
                    </div>
                </div>

                <div class="privacy-notice">
                    <h4>Privacy & Data Handling</h4>
                    <p>
                        Your responses are stored locally on your device and are never sent to any server
                        without your explicit action. You can export your results as a PDF or optionally
                        share them directly with Dr. Alen for personalized consultation.
                    </p>
                </div>

                <div class="assessment-includes">
                    <h4>This Assessment Includes</h4>
                    <ul>
                        <li>Sleep schedule and habits evaluation</li>
                        <li>Epworth Sleepiness Scale (daytime sleepiness)</li>
                        <li>Insomnia Severity Index</li>
                        <li>STOP-BANG sleep apnea screening</li>
                        <li>Restless Legs Syndrome screening</li>
                        <li>Parasomnia and circadian rhythm assessment</li>
                        <li>Environment and lifestyle factors</li>
                        <li>Optional wearable data integration</li>
                    </ul>
                </div>

                <div class="resume-notice" id="resumeNotice" style="display: none;">
                    <h4>Continue Where You Left Off</h4>
                    <p>We found saved progress from a previous session.</p>
                    <div class="resume-actions">
                        <button class="btn-secondary" onclick="App.clearAndRestart()">Start Fresh</button>
                        <button class="btn-primary" onclick="App.resumeAssessment()">Continue Assessment</button>
                    </div>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-primary btn-large" onclick="App.startAssessment()">Begin Assessment</button>
            </div>
        </section>

        <!-- Step 2: Client Type -->
        <section class="step-section" data-step="clientType">
            <p class="step-label">Step 1 of 11</p>
            <h2 class="step-title">How Would You Describe Yourself?</h2>
            <p class="step-subtitle">This helps us tailor the assessment and recommendations to your specific needs.</p>

            <div class="client-type-grid">
                <button class="client-type-card" data-type="athlete" onclick="App.selectClientType('athlete')">
                    <div class="client-type-icon athlete">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 2a10 10 0 0 1 0 20M12 2a10 10 0 0 0 0 20M2 12h20"/>
                        </svg>
                    </div>
                    <h3>Elite Athlete</h3>
                    <p>Professional or competitive athlete seeking performance optimization</p>
                </button>

                <button class="client-type-card" data-type="executive" onclick="App.selectClientType('executive')">
                    <div class="client-type-icon executive">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="2" y="3" width="20" height="14" rx="2"/>
                            <path d="M8 21h8M12 17v4"/>
                        </svg>
                    </div>
                    <h3>Corporate Executive</h3>
                    <p>Business leader seeking sharper decision-making and sustained energy</p>
                </button>

                <button class="client-type-card" data-type="hotel" onclick="App.selectClientType('hotel')">
                    <div class="client-type-icon hotel">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M3 21h18M3 10h18M3 7l9-4 9 4M4 10v11M20 10v11M8 14v3M12 14v3M16 14v3"/>
                        </svg>
                    </div>
                    <h3>Hotel Guest</h3>
                    <p>Traveler seeking better sleep quality during stays</p>
                </button>
            </div>
        </section>

        <!-- Step 3: Demographics -->
        <section class="step-section" data-step="demographics">
            <p class="step-label">Step 2 of 11</p>
            <h2 class="step-title">Basic Information</h2>
            <p class="step-subtitle">This information helps us provide more accurate assessments and recommendations.</p>

            <div class="form-grid">
                <div class="form-group">
                    <label for="age">Age</label>
                    <input type="number" id="age" name="age" min="18" max="100" placeholder="Enter your age">
                </div>

                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select id="gender" name="gender">
                        <option value="">Select gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other / Prefer not to say</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="height">Height (cm)</label>
                    <input type="number" id="height" name="height" min="100" max="250" placeholder="e.g., 175">
                </div>

                <div class="form-group">
                    <label for="weight">Weight (kg)</label>
                    <input type="number" id="weight" name="weight" min="30" max="300" placeholder="e.g., 70">
                </div>

                <div class="form-group full-width">
                    <label for="neckCircumference">Neck Circumference (cm) <span class="optional">(optional)</span></label>
                    <input type="number" id="neckCircumference" name="neckCircumference" min="20" max="60" placeholder="e.g., 40">
                    <p class="form-hint">Measure around the base of your neck. This helps assess sleep apnea risk.</p>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 4: Sleep Schedule -->
        <section class="step-section" data-step="sleepSchedule">
            <p class="step-label">Step 3 of 11</p>
            <h2 class="step-title">Your Sleep Schedule</h2>
            <p class="step-subtitle">Tell us about your typical sleep patterns over the past month.</p>

            <div class="form-grid">
                <div class="form-group">
                    <label for="bedtime">Typical Bedtime</label>
                    <input type="time" id="bedtime" name="bedtime" value="23:00">
                </div>

                <div class="form-group">
                    <label for="waketime">Typical Wake Time</label>
                    <input type="time" id="waketime" name="waketime" value="07:00">
                </div>

                <div class="form-group">
                    <label for="sleepLatency">How long does it take you to fall asleep? (minutes)</label>
                    <input type="number" id="sleepLatency" name="sleepLatency" min="0" max="180" placeholder="e.g., 15">
                </div>

                <div class="form-group">
                    <label for="awakenings">How many times do you typically wake up during the night?</label>
                    <select id="awakenings" name="awakenings">
                        <option value="0">0 - I sleep through the night</option>
                        <option value="1">1 time</option>
                        <option value="2">2 times</option>
                        <option value="3">3 times</option>
                        <option value="4">4 or more times</option>
                    </select>
                </div>

                <div class="form-group full-width">
                    <label for="wakeTime">When you wake during the night, how long are you typically awake? (minutes)</label>
                    <input type="number" id="wakeTime" name="wakeTime" min="0" max="180" placeholder="e.g., 10">
                </div>

                <div class="form-group full-width">
                    <label for="sleepQuality">How would you rate your overall sleep quality?</label>
                    <div class="rating-scale">
                        <label class="rating-option">
                            <input type="radio" name="sleepQuality" value="1">
                            <span>1<br><small>Very Poor</small></span>
                        </label>
                        <label class="rating-option">
                            <input type="radio" name="sleepQuality" value="2">
                            <span>2<br><small>Poor</small></span>
                        </label>
                        <label class="rating-option">
                            <input type="radio" name="sleepQuality" value="3">
                            <span>3<br><small>Fair</small></span>
                        </label>
                        <label class="rating-option">
                            <input type="radio" name="sleepQuality" value="4">
                            <span>4<br><small>Good</small></span>
                        </label>
                        <label class="rating-option">
                            <input type="radio" name="sleepQuality" value="5">
                            <span>5<br><small>Excellent</small></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 5: Epworth Sleepiness Scale -->
        <section class="step-section" data-step="epworth">
            <p class="step-label">Step 4 of 11</p>
            <h2 class="step-title">Epworth Sleepiness Scale</h2>
            <p class="step-subtitle">
                How likely are you to doze off or fall asleep in the following situations?
                This refers to your usual way of life in recent times.
            </p>

            <div class="questionnaire-intro">
                <p><strong>0</strong> = Would never doze</p>
                <p><strong>1</strong> = Slight chance of dozing</p>
                <p><strong>2</strong> = Moderate chance of dozing</p>
                <p><strong>3</strong> = High chance of dozing</p>
            </div>

            <div class="questionnaire-items" id="epworthQuestions">
                <!-- Generated by JS -->
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 6: Insomnia Severity Index -->
        <section class="step-section" data-step="isi">
            <p class="step-label">Step 5 of 11</p>
            <h2 class="step-title">Insomnia Severity Index</h2>
            <p class="step-subtitle">Please rate the current (i.e., last 2 weeks) severity of your insomnia problem(s).</p>

            <div class="questionnaire-items" id="isiQuestions">
                <!-- Generated by JS -->
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 7: STOP-BANG -->
        <section class="step-section" data-step="stopbang">
            <p class="step-label">Step 6 of 11</p>
            <h2 class="step-title">STOP-BANG Sleep Apnea Screening</h2>
            <p class="step-subtitle">Answer yes or no to the following questions to assess sleep apnea risk.</p>

            <div class="questionnaire-items yes-no" id="stopbangQuestions">
                <!-- Generated by JS -->
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 8: Additional Disorder Screening -->
        <section class="step-section" data-step="disorders">
            <p class="step-label">Step 7 of 11</p>
            <h2 class="step-title">Additional Sleep Disorder Screening</h2>
            <p class="step-subtitle">These questions help identify other potential sleep-related conditions.</p>

            <div class="disorder-section">
                <h3>Restless Legs Syndrome</h3>
                <div class="questionnaire-items yes-no" id="rlsQuestions">
                    <!-- Generated by JS -->
                </div>
            </div>

            <div class="disorder-section">
                <h3>Parasomnias</h3>
                <div class="questionnaire-items" id="parasomniasQuestions">
                    <!-- Generated by JS -->
                </div>
            </div>

            <div class="disorder-section">
                <h3>REM Behavior Disorder</h3>
                <div class="questionnaire-items yes-no" id="remQuestions">
                    <!-- Generated by JS -->
                </div>
            </div>

            <div class="disorder-section">
                <h3>Circadian Rhythm</h3>
                <div class="questionnaire-items" id="circadianQuestions">
                    <!-- Generated by JS -->
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 9: Environment & Lifestyle -->
        <section class="step-section" data-step="environment">
            <p class="step-label">Step 8 of 11</p>
            <h2 class="step-title">Environment & Lifestyle</h2>
            <p class="step-subtitle">Your sleep environment and daily habits significantly impact sleep quality.</p>

            <div class="form-grid">
                <div class="form-group">
                    <label for="bedroomTemp">How would you describe your bedroom temperature?</label>
                    <select id="bedroomTemp" name="bedroomTemp">
                        <option value="">Select option</option>
                        <option value="too_cold">Too cold</option>
                        <option value="cool">Cool (optimal)</option>
                        <option value="comfortable">Comfortable</option>
                        <option value="warm">Warm</option>
                        <option value="too_hot">Too hot</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="bedroomLight">How dark is your bedroom when sleeping?</label>
                    <select id="bedroomLight" name="bedroomLight">
                        <option value="">Select option</option>
                        <option value="completely_dark">Completely dark</option>
                        <option value="mostly_dark">Mostly dark (small light sources)</option>
                        <option value="some_light">Some light (streetlights, electronics)</option>
                        <option value="bright">Fairly bright</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="bedroomNoise">How would you describe noise levels in your bedroom?</label>
                    <select id="bedroomNoise" name="bedroomNoise">
                        <option value="">Select option</option>
                        <option value="silent">Silent</option>
                        <option value="quiet">Quiet (occasional sounds)</option>
                        <option value="moderate">Moderate noise</option>
                        <option value="noisy">Noisy</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="mattressAge">How old is your mattress?</label>
                    <select id="mattressAge" name="mattressAge">
                        <option value="">Select option</option>
                        <option value="new">Less than 3 years</option>
                        <option value="moderate">3-7 years</option>
                        <option value="old">7-10 years</option>
                        <option value="very_old">More than 10 years</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="caffeineIntake">Daily caffeine intake</label>
                    <select id="caffeineIntake" name="caffeineIntake">
                        <option value="">Select option</option>
                        <option value="none">None</option>
                        <option value="1-2">1-2 cups coffee/tea</option>
                        <option value="3-4">3-4 cups</option>
                        <option value="5+">5 or more cups</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="caffeineTime">Last caffeine intake before bed</label>
                    <select id="caffeineTime" name="caffeineTime">
                        <option value="">Select option</option>
                        <option value="none">I don't consume caffeine</option>
                        <option value="8+">8+ hours before bed</option>
                        <option value="6-8">6-8 hours before bed</option>
                        <option value="4-6">4-6 hours before bed</option>
                        <option value="2-4">2-4 hours before bed</option>
                        <option value="<2">Less than 2 hours before bed</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="alcoholIntake">Alcohol consumption (drinks per week)</label>
                    <select id="alcoholIntake" name="alcoholIntake">
                        <option value="">Select option</option>
                        <option value="none">None</option>
                        <option value="1-3">1-3 drinks</option>
                        <option value="4-7">4-7 drinks</option>
                        <option value="8-14">8-14 drinks</option>
                        <option value="14+">More than 14 drinks</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="screenTime">Screen use before bed (phone, TV, computer)</label>
                    <select id="screenTime" name="screenTime">
                        <option value="">Select option</option>
                        <option value="none">No screens 1+ hour before bed</option>
                        <option value="30-60">Stop 30-60 minutes before bed</option>
                        <option value="15-30">Stop 15-30 minutes before bed</option>
                        <option value="until_bed">Use until bedtime</option>
                        <option value="in_bed">Use screens in bed</option>
                    </select>
                </div>

                <div class="form-group full-width">
                    <label for="exerciseFrequency">Exercise frequency</label>
                    <select id="exerciseFrequency" name="exerciseFrequency">
                        <option value="">Select option</option>
                        <option value="none">No regular exercise</option>
                        <option value="1-2">1-2 times per week</option>
                        <option value="3-4">3-4 times per week</option>
                        <option value="5+">5+ times per week</option>
                        <option value="daily">Daily</option>
                    </select>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 10: Client-Specific Questions -->
        <section class="step-section" data-step="clientSpecific">
            <p class="step-label">Step 9 of 11</p>
            <h2 class="step-title" id="clientSpecificTitle">Additional Questions</h2>
            <p class="step-subtitle" id="clientSpecificSubtitle">Questions specific to your profile.</p>

            <!-- Athlete Questions -->
            <div class="client-specific-section" id="athleteQuestions" style="display: none;">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="trainingHours">Training hours per week</label>
                        <input type="number" id="trainingHours" name="trainingHours" min="0" max="60" placeholder="e.g., 20">
                    </div>

                    <div class="form-group">
                        <label for="trainingTime">Primary training time</label>
                        <select id="trainingTime" name="trainingTime">
                            <option value="">Select option</option>
                            <option value="morning">Morning (before 10am)</option>
                            <option value="midday">Midday (10am-2pm)</option>
                            <option value="afternoon">Afternoon (2pm-6pm)</option>
                            <option value="evening">Evening (after 6pm)</option>
                            <option value="varies">Varies significantly</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="competitionTravel">Competition travel frequency</label>
                        <select id="competitionTravel" name="competitionTravel">
                            <option value="">Select option</option>
                            <option value="rarely">Rarely (few times/year)</option>
                            <option value="monthly">Monthly</option>
                            <option value="biweekly">Every 2 weeks</option>
                            <option value="weekly">Weekly or more</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="timeZonesCrossed">Time zones crossed per month (average)</label>
                        <input type="number" id="timeZonesCrossed" name="timeZonesCrossed" min="0" max="50" placeholder="e.g., 6">
                    </div>

                    <div class="form-group">
                        <label for="nappingHabits">Napping habits</label>
                        <select id="nappingHabits" name="nappingHabits">
                            <option value="">Select option</option>
                            <option value="never">Never nap</option>
                            <option value="occasionally">Occasionally (1-2x/week)</option>
                            <option value="regularly">Regularly (3-5x/week)</option>
                            <option value="daily">Daily</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="preCompSleep">Sleep before important competitions</label>
                        <select id="preCompSleep" name="preCompSleep">
                            <option value="">Select option</option>
                            <option value="better">Better than usual</option>
                            <option value="same">Same as usual</option>
                            <option value="worse">Worse than usual</option>
                            <option value="much_worse">Much worse than usual</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label for="performanceCorrelation">Do you notice a correlation between sleep quality and performance?</label>
                        <select id="performanceCorrelation" name="performanceCorrelation">
                            <option value="">Select option</option>
                            <option value="strong">Strong correlation - poor sleep clearly affects performance</option>
                            <option value="moderate">Moderate correlation - sometimes notice effects</option>
                            <option value="weak">Weak correlation - rarely notice effects</option>
                            <option value="none">No noticeable correlation</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Executive Questions -->
            <div class="client-specific-section" id="executiveQuestions" style="display: none;">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="workHours">Work hours per week</label>
                        <input type="number" id="workHours" name="workHours" min="20" max="100" placeholder="e.g., 50">
                    </div>

                    <div class="form-group">
                        <label for="travelFrequency">International travel frequency</label>
                        <select id="travelFrequency" name="travelFrequency">
                            <option value="">Select option</option>
                            <option value="rarely">Rarely (few times/year)</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="monthly">Monthly</option>
                            <option value="weekly">Weekly or more</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="execTimeZones">Time zones crossed per month (average)</label>
                        <input type="number" id="execTimeZones" name="execTimeZones" min="0" max="50" placeholder="e.g., 4">
                    </div>

                    <div class="form-group">
                        <label for="eveningWork">Evening device use for work</label>
                        <select id="eveningWork" name="eveningWork">
                            <option value="">Select option</option>
                            <option value="never">Never</option>
                            <option value="occasionally">Occasionally</option>
                            <option value="often">Often</option>
                            <option value="always">Almost every evening</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="stressLevel">Current stress level (1-10)</label>
                        <div class="rating-scale compact">
                            <label class="rating-option"><input type="radio" name="stressLevel" value="1"><span>1</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="2"><span>2</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="3"><span>3</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="4"><span>4</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="5"><span>5</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="6"><span>6</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="7"><span>7</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="8"><span>8</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="9"><span>9</span></label>
                            <label class="rating-option"><input type="radio" name="stressLevel" value="10"><span>10</span></label>
                        </div>
                        <p class="form-hint">1 = Very low stress, 10 = Extremely high stress</p>
                    </div>

                    <div class="form-group">
                        <label for="decisionFrequency">Frequency of high-stakes decisions</label>
                        <select id="decisionFrequency" name="decisionFrequency">
                            <option value="">Select option</option>
                            <option value="rarely">Rarely</option>
                            <option value="weekly">Weekly</option>
                            <option value="several">Several times per week</option>
                            <option value="daily">Daily</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Hotel Guest Questions -->
            <div class="client-specific-section" id="hotelQuestions" style="display: none;">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="stayPurpose">Primary purpose of hotel stays</label>
                        <select id="stayPurpose" name="stayPurpose">
                            <option value="">Select option</option>
                            <option value="business">Business travel</option>
                            <option value="leisure">Leisure/vacation</option>
                            <option value="both">Mix of both</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="hotelFrequency">Typical hotel stays per year</label>
                        <select id="hotelFrequency" name="hotelFrequency">
                            <option value="">Select option</option>
                            <option value="1-5">1-5 nights</option>
                            <option value="6-15">6-15 nights</option>
                            <option value="16-30">16-30 nights</option>
                            <option value="30-60">30-60 nights</option>
                            <option value="60+">More than 60 nights</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label for="hotelVsHome">How does your sleep quality in hotels compare to home?</label>
                        <select id="hotelVsHome" name="hotelVsHome">
                            <option value="">Select option</option>
                            <option value="better">Better than home</option>
                            <option value="same">About the same</option>
                            <option value="slightly_worse">Slightly worse</option>
                            <option value="much_worse">Much worse</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label>What issues affect your hotel sleep? (select all that apply)</label>
                        <div class="checkbox-grid">
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="unfamiliar_bed">
                                <span>Unfamiliar bed</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="noise">
                                <span>Noise</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="temperature">
                                <span>Temperature control</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="light">
                                <span>Light leakage</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="jet_lag">
                                <span>Jet lag</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="schedule">
                                <span>Disrupted schedule</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="anxiety">
                                <span>Travel anxiety</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="hotelIssues" value="pillows">
                                <span>Pillows/bedding</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.nextStep()">Continue</button>
            </div>
        </section>

        <!-- Step 11: Wearable Data -->
        <section class="step-section" data-step="wearable">
            <p class="step-label">Step 10 of 11</p>
            <h2 class="step-title">Wearable Data (Optional)</h2>
            <p class="step-subtitle">
                If you use a sleep tracker, you can upload your data for more comprehensive analysis.
            </p>

            <div class="wearable-section">
                <div class="upload-zone" id="uploadZone">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="upload-icon">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                    <p>Drag and drop your sleep data file here</p>
                    <p class="upload-hint">or click to browse</p>
                    <input type="file" id="wearableFile" accept=".csv,.json,.xlsx" style="display: none;">
                </div>
                <p class="upload-status" id="uploadStatus"></p>
            </div>

            <div class="wearable-instructions">
                <h4>Export Instructions by Device</h4>

                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>WHOOP</span>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="accordion-icon">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </button>
                        <div class="accordion-content">
                            <ol>
                                <li>Open the WHOOP app</li>
                                <li>Go to Profile > Settings > Data Export</li>
                                <li>Select date range and export as CSV</li>
                                <li>Email the file to yourself and upload here</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>Oura Ring</span>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="accordion-icon">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </button>
                        <div class="accordion-content">
                            <ol>
                                <li>Log into cloud.ouraring.com</li>
                                <li>Navigate to Settings > Data Export</li>
                                <li>Select "Sleep" data and date range</li>
                                <li>Download and upload the JSON file</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>Apple Watch</span>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="accordion-icon">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </button>
                        <div class="accordion-content">
                            <ol>
                                <li>Open the Health app on your iPhone</li>
                                <li>Tap your profile picture > Export All Health Data</li>
                                <li>Wait for export to complete (may take a few minutes)</li>
                                <li>Upload the export.zip file</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>Fitbit</span>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="accordion-icon">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </button>
                        <div class="accordion-content">
                            <ol>
                                <li>Log into fitbit.com</li>
                                <li>Go to Settings > Data Export</li>
                                <li>Request your data export</li>
                                <li>Download and upload the file when ready</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>Garmin</span>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="accordion-icon">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </button>
                        <div class="accordion-content">
                            <ol>
                                <li>Log into connect.garmin.com</li>
                                <li>Go to Settings > Account Information > Export Your Data</li>
                                <li>Request export and wait for email</li>
                                <li>Download and upload the file</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.previousStep()">Back</button>
                <button class="btn-primary" onclick="App.calculateResults()">View Results</button>
            </div>
        </section>

        <!-- Step 12: Results -->
        <section class="step-section" data-step="results">
            <div class="results-header">
                <p class="step-label">Your Results</p>
                <h2 class="step-title">Sleep Health Assessment</h2>
            </div>

            <!-- Overall Score -->
            <div class="overall-score-section">
                <div class="overall-score-card">
                    <div class="score-circle" id="overallScoreCircle">
                        <svg viewBox="0 0 120 120">
                            <circle cx="60" cy="60" r="54" class="score-bg"/>
                            <circle cx="60" cy="60" r="54" class="score-fill" id="scoreCircleFill"/>
                        </svg>
                        <div class="score-value" id="overallScoreValue">--</div>
                    </div>
                    <div class="score-label">Overall Sleep Health Score</div>
                    <div class="score-interpretation" id="scoreInterpretation"></div>
                </div>
            </div>

            <!-- Individual Scores -->
            <div class="individual-scores" id="individualScores">
                <!-- Generated by JS -->
            </div>

            <!-- Key Findings -->
            <div class="findings-section">
                <h3>Key Findings</h3>
                <div class="findings-list" id="findingsList">
                    <!-- Generated by JS -->
                </div>
            </div>

            <!-- Recommendations -->
            <div class="recommendations-section">
                <h3>Recommendations</h3>
                <div class="recommendations-list" id="recommendationsList">
                    <!-- Generated by JS -->
                </div>
            </div>

            <!-- Therapeutic Modules -->
            <div class="modules-section">
                <h3>Therapeutic Resources</h3>
                <p class="modules-intro">
                    Access evidence-based therapeutic content to improve your sleep. Some modules require an unlock code from Dr. Alen.
                </p>

                <div class="unlock-input-section" id="unlockSection">
                    <div class="unlock-form">
                        <input type="text" id="unlockCode" placeholder="Enter unlock code">
                        <button class="btn-primary" onclick="Content.verifyUnlockCode()">Unlock</button>
                    </div>
                    <p class="unlock-hint">Contact Dr. Alen to receive your personalized unlock code.</p>
                </div>

                <div class="modules-grid" id="modulesGrid">
                    <!-- Generated by JS -->
                </div>
            </div>

            <!-- Export Options -->
            <div class="export-section">
                <h3>Save Your Results</h3>
                <div class="export-buttons">
                    <button class="btn-secondary" onclick="Export.downloadPDF()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Download PDF Report
                    </button>
                    <button class="btn-primary" onclick="Export.emailResults()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                            <polyline points="22,6 12,13 2,6"/>
                        </svg>
                        Send to Dr. Alen
                    </button>
                </div>
            </div>

            <div class="step-actions">
                <button class="btn-secondary" onclick="App.restartAssessment()">Start New Assessment</button>
            </div>
        </section>

        <!-- Therapeutic Content Modal -->
        <div class="modal" id="contentModal">
            <div class="modal-content">
                <button class="modal-close" onclick="Content.closeModal()">&times;</button>
                <div class="modal-body" id="modalBody">
                    <!-- Content loaded dynamically -->
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Footer -->
<footer class="footer">
    <span class="footer-brand">SLEEP WELLNESS</span>
    <div class="footer-links">
        <a href="../index.html">Home</a>
        <a href="../hotels.html">Hotels</a>
        <a href="../athletes.html">Athletes</a>
        <a href="../corporate.html">Corporate</a>
    </div>
    <span class="footer-text">Â© 2026 Dr. Alen Juginovic</span>
</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>
<script src="auth.js"></script>

<!-- Scripts -->
<script src="storage.js"></script>
<script src="questionnaires.js"></script>
<script src="content.js"></script>
<script src="results.js"></script>
<script src="export.js"></script>
<script src="app.js"></script>

<script>
    // Authentication check - redirect to auth if not logged in
    let currentAssessmentUser = null;

    auth.onAuthStateChanged(async (user) => {
        if (!user) {
            // Not logged in - redirect to auth
            window.location.href = 'auth.html?redirect=' + encodeURIComponent(window.location.pathname);
            return;
        }

        currentAssessmentUser = user;

        // Load user's unlocked modules from Firebase
        const unlocks = await FirebaseDB.getUserUnlocks(user.uid);
        if (unlocks && unlocks.length > 0) {
            unlocks.forEach(moduleId => {
                Storage.addUnlockedModule(moduleId);
            });
        }
    });

    // Override the save results function to also save to Firebase
    const originalSaveResults = Storage.saveResults;
    Storage.saveResults = async function(results) {
        // Save locally first
        originalSaveResults.call(this, results);

        // Then save to Firebase if logged in
        if (currentAssessmentUser) {
            try {
                await FirebaseDB.saveAssessment(currentAssessmentUser.uid, results);
                console.log('Assessment saved to Firebase');
            } catch (error) {
                console.error('Error saving to Firebase:', error);
            }
        }
    };
</script>

</body>
</html>
